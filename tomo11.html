<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tomo 11: Radar Visual - Manual de Instrumentaci贸n</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="tomo-style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/arduino-light.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
</head>
<body>
    <header>
        <div class="header-container">
            <h1>Tomo 11: Radar Visual de Proximidad</h1>
        </div>
    </header>
    <main class="tomo-content">
<div class="nav-links">
            <a href="index.html" class="nav-link">&larr; Volver al ndice</a>
            <a href="tomo12.html" class="nav-link">Tomo Siguiente &rarr;</a>
        </div>
        <p>隆Bienvenidos al tercer parcial y a los sistemas avanzados! Hoy le daremos a nuestro Arduino un s煤per poder digno de un murci茅lago o un submarino: la <strong>ecolocalizaci贸n</strong>. Usaremos un sensor ultras贸nico no solo para medir distancias, sino para visualizar esa informaci贸n de m煤ltiples maneras: en una pantalla, con un indicador f铆sico (servo) y en una barra de LEDs. 隆Construiremos un radar interactivo completo!</p>

        <div class="protagonista-section">
            <h3> Protagonista de Hoy: El Sensor Ultras贸nico HC-SR04</h3>
            <p>Este sensor funciona como un sonar: emite un pulso de sonido a una frecuencia tan alta que no podemos o铆rla (ultrasonido) desde su pin <strong>Trig</strong> (Disparador). Luego, escucha el "eco" de ese sonido rebotando en un objeto con su pin <strong>Echo</strong> (Eco). El tiempo que tarda el eco en regresar nos permite calcular la distancia con gran precisi贸n usando la velocidad del sonido.</p>
            <div class="image-container">
            <img src="AR0008-Sensor-Ultrasonico-V4.jpg" alt="pinout ultrasonico">
            </div>
        </div>

        <h2> El C贸digo: El Cerebro del Radar Visual</h2>
        <p>Este c贸digo integra la lectura del sensor, el control de la pantalla, el movimiento del servo y la l贸gica para la barra de LEDs, todo en un solo sketch.</p>
        <div class="code-container"> 
    <div class="code-header">
        <span>C贸digo Arduino</span>
        <button class="copy-btn">Copiar</button>
    </div> 
<pre><code class="language-cpp code-block">
/*
 * Misi贸n 11 (Final): Radar Visual de Proximidad
 * Descripci贸n: Mide distancia, la muestra en LCD, mueve un servo y
 * controla una barra de 8 LEDs de forma proporcional.
 * Por: Profe Campos
 * CECyTEM 05 Guacamayas
*/

// --- LIBRERAS ---
#include &lt;Wire.h&gt;
#include &lt;LiquidCrystal_I2C.h&gt;
#include &lt;Servo.h&gt;

// --- PINES ---
const int pinTrig = 3;
const int pinEcho = 2;
const int pinServo = 5;
// Array para los pines de los 8 LEDs
const int pinesLeds[] = {6, 7, 8, 9, 10, 11, 12, 13};
const int numLeds = 8;

// --- OBJETOS ---
LiquidCrystal_I2C lcd(0x27, 16, 2);
Servo miServo;

// --- VARIABLES ---
long duracion;
int distancia;
int angulo;

void setup() {
  Serial.begin(9600);
  
  pinMode(pinTrig, OUTPUT);
  pinMode(pinEcho, INPUT);
  
  // Configurar todos los pines de los LEDs como salida
  for (int i = 0; i < numLeds; i++) {
    pinMode(pinesLeds[i], OUTPUT);
  }
  
  miServo.attach(pinServo);
  
  lcd.init();
  lcd.backlight();
  lcd.print("Radar Activado");
  delay(1500);
  lcd.clear();
}

void loop() {
  // --- PASO 1: MEDIR LA DISTANCIA ---
  digitalWrite(pinTrig, LOW);
  delayMicroseconds(2);
  digitalWrite(pinTrig, HIGH);
  delayMicroseconds(10);
  digitalWrite(pinTrig, LOW);
  duracion = pulseIn(pinEcho, HIGH);
  distancia = duracion * 0.0343 / 2;

  // --- PASO 2: MOSTRAR EN MONITOR Y LCD ---
  Serial.print("Distancia: ");
  Serial.print(distancia);
  Serial.println(" cm");
  
  lcd.clear();
  lcd.setCursor(0, 0);
  lcd.print("Distancia:");
  lcd.setCursor(0, 1);
  lcd.print(distancia);
  lcd.print(" cm");

  // --- PASO 3: MOVER EL SERVO ---
  angulo = map(distancia, 4, 50, 0, 180);
  miServo.write(angulo);

  // --- PASO 4: CONTROLAR LA BARRA DE LEDS ---
  // Mapeamos la distancia (de 50 a 4 cm) al n煤mero de LEDs (0 a 8)
  // Nota: Los valores de distancia est谩n invertidos para que a menor distancia, m谩s LEDs se enciendan.
  int ledsEncendidos = map(distancia, 50, 4, 0, numLeds);
  
  // Nos aseguramos que el valor est茅 siempre entre 0 y 8
  ledsEncendidos = constrain(ledsEncendidos, 0, numLeds);

  // Recorremos todos los LEDs y los encendemos o apagamos seg煤n corresponda
  for (int i = 0; i < numLeds; i++) {
    if (i < ledsEncendidos) {
      digitalWrite(pinesLeds[i], HIGH); // Encendemos si su 铆ndice es menor
    } else {
      digitalWrite(pinesLeds[i], LOW); // Apagamos si su 铆ndice es mayor
    }
  }

  delay(100);
}
        </code></pre>
         </div>
        <h2> Manos a la Obra: El Circuito</h2>
        <p>Este es nuestro circuito m谩s poblado hasta ahora. Integraremos el sensor ultras贸nico, el servo, la pantalla LCD y los 8 LEDs. La clave es la organizaci贸n de los cables.</p>
        <div class="image-container">
            <h3>Diagrama del Circuito 11</h3>
            <img src="Tomo 11.png" alt="Diagrama de conexi贸n del sensor ultras贸nico, servo, LCD y 8 LEDs">
        </div>

        <h2> Conceptos Clave de la Misi贸n</h2>
        <ul>
            <li><strong>Ecolocalizaci贸n:</strong> El principio de usar ondas (de sonido, en este caso) y sus ecos para localizar objetos en el espacio.</li>
            <li><strong>Funci贸n `pulseIn()`:</strong> Mide la duraci贸n de un pulso, ideal para este sensor.</li>
            <li><strong>Visualizaci贸n de Datos:</strong> Representar una variable (distancia) de m煤ltiples formas (num茅rica, posicional, gr谩fica) para una mejor interpretaci贸n.</li>
        </ul>

        <h2> 隆Int茅ntalo T煤 Mismo! (Retos)</h2>
        <ul>
            <li><strong>Indicador Visual de Estado:</strong> Transforma la barra de LEDs en un indicador de estado. Usa LEDs de diferentes colores (verdes, amarillos, rojos) para crear una escala de advertencia visual.</li>
            <li><strong>Barrera de Estacionamiento Autom谩tica:</strong> Programa el servo para que simule una barrera. Cuando un objeto se acerque a menos de 10 cm, la barrera debe bajar (0 grados) y no subir hasta que el objeto se aleje.</li>
            <li><strong>Radar Ac煤stico de Mapeo:</strong> A帽ade un buzzer y sincron铆zalo con el servo. Haz que el servo "escanee" de 0 a 180 grados y que el buzzer emita "pings" cuyo tono cambie seg煤n la distancia detectada.</li>
        </ul>
<div class="nav-links bottom-nav-links">
            <a href="index.html" class="nav-link">&larr; Volver al ndice</a>
            <a href="tomo12.html" class="nav-link">Tomo Siguiente &rarr;</a>
        </div>    </main>
    <footer>
        <p>Manual Digital de Instrumentaci贸n Industrial | CECyTEM 05 Guacamayas</p>
    </footer>
        <script>hljs.highlightAll();</script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Busca todos los botones de copiar
    const allCopyButtons = document.querySelectorAll('.copy-btn');

    allCopyButtons.forEach(button => {
        button.addEventListener('click', function() {
            // Encuentra el contenedor de c贸digo m谩s cercano
            const codeContainer = this.closest('.code-container');
            // Encuentra el bloque de c贸digo dentro de ese contenedor
            const codeBlock = codeContainer.querySelector('code');
            
            if (codeBlock) {
                // Copia el texto del c贸digo al portapapeles
                navigator.clipboard.writeText(codeBlock.innerText).then(() => {
                    // Feedback visual para el usuario
                    this.innerText = '隆Copiado!';
                    setTimeout(() => {
                        this.innerText = 'Copiar';
                    }, 2000); // Vuelve al texto original despu茅s de 2 segundos
                }).catch(err => {
                    console.error('Error al copiar el c贸digo: ', err);
                });
            }
        });
    });
});
</script>
</body>

</html>






